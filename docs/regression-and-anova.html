<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Regression and ANOVA | [PSY202A Lab] Statistical Modeling in Psychological Sciences</title>
  <meta name="description" content="This GitBook is for guest lectures in PSY202A." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Regression and ANOVA | [PSY202A Lab] Statistical Modeling in Psychological Sciences" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This GitBook is for guest lectures in PSY202A." />
  <meta name="github-repo" content="ihnwhiheo/gitbook-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Regression and ANOVA | [PSY202A Lab] Statistical Modeling in Psychological Sciences" />
  
  <meta name="twitter:description" content="This GitBook is for guest lectures in PSY202A." />
  

<meta name="author" content="Ihnwhi Heo, M.Sc." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="summarizing-data.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/IhnwhiHeo/PSY202A_Modeling/">PSY202A Statistical Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html"><i class="fa fa-check"></i><b>2</b> Introduction to R: Part 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#word-of-wisdom"><i class="fa fa-check"></i><b>2.1</b> Word of wisdom</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#how-r-you"><i class="fa fa-check"></i><b>2.2</b> How R you?</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#open-rstudio"><i class="fa fa-check"></i><b>2.2.1</b> Open RStudio</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#open-a-new-r-script"><i class="fa fa-check"></i><b>2.2.2</b> Open a new R script</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#individualize-r"><i class="fa fa-check"></i><b>2.2.3</b> Individualize R</a></li>
<li class="chapter" data-level="2.2.4" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#some-useful-settings"><i class="fa fa-check"></i><b>2.2.4</b> Some useful settings</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#interacting-with-r"><i class="fa fa-check"></i><b>2.3</b> Interacting with R</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#computation"><i class="fa fa-check"></i><b>2.4</b> Computation</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#using-r-as-a-numerical-calculator"><i class="fa fa-check"></i><b>2.4.1</b> Using R as a numerical calculator</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#using-r-as-a-logical-calculator"><i class="fa fa-check"></i><b>2.4.2</b> Using R as a logical calculator</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#types-of-objects"><i class="fa fa-check"></i><b>2.5</b> Types of objects</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#vector-intro"><i class="fa fa-check"></i><b>2.5.1</b> Vector: Intro</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#vector-advanced"><i class="fa fa-check"></i><b>2.5.2</b> Vector: Advanced</a></li>
<li class="chapter" data-level="2.5.3" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#matrix-intro"><i class="fa fa-check"></i><b>2.5.3</b> Matrix: intro</a></li>
<li class="chapter" data-level="2.5.4" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#matrix-advanced"><i class="fa fa-check"></i><b>2.5.4</b> Matrix: advanced</a></li>
<li class="chapter" data-level="2.5.5" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#data-frame"><i class="fa fa-check"></i><b>2.5.5</b> Data frame</a></li>
<li class="chapter" data-level="2.5.6" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#list"><i class="fa fa-check"></i><b>2.5.6</b> List</a></li>
<li class="chapter" data-level="2.5.7" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#exercise-selecting-elements-in-objects"><i class="fa fa-check"></i><b>2.5.7</b> Exercise: Selecting elements in objects</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#workspace"><i class="fa fa-check"></i><b>2.6</b> Workspace</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#functions-to-manage-workspace"><i class="fa fa-check"></i><b>2.6.1</b> Functions to manage workspace</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#working-directory"><i class="fa fa-check"></i><b>2.7</b> Working directory</a></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#importing-external-data"><i class="fa fa-check"></i><b>2.8</b> Importing external data</a></li>
<li class="chapter" data-level="2.9" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#exporting"><i class="fa fa-check"></i><b>2.9</b> Exporting</a></li>
<li class="chapter" data-level="2.10" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#final-exercise"><i class="fa fa-check"></i><b>2.10</b> Final exercise</a></li>
<li class="chapter" data-level="2.11" data-path="introduction-to-r-part-1.html"><a href="introduction-to-r-part-1.html#r-markdown"><i class="fa fa-check"></i><b>2.11</b> R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html"><i class="fa fa-check"></i><b>3</b> Introduction to R: Part 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#what-will-we-do"><i class="fa fa-check"></i><b>3.1</b> What will we do?</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#packages"><i class="fa fa-check"></i><b>3.2</b> Packages</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#installing-packages"><i class="fa fa-check"></i><b>3.2.1</b> Installing packages</a></li>
<li class="chapter" data-level="3.2.2" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#loading-packages"><i class="fa fa-check"></i><b>3.2.2</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#getting-help"><i class="fa fa-check"></i><b>3.3</b> Getting help</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#modern-way-of-getting-help"><i class="fa fa-check"></i><b>3.3.1</b> Modern way of getting help</a></li>
<li class="chapter" data-level="3.3.2" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#traditional-way-of-getting-help"><i class="fa fa-check"></i><b>3.3.2</b> Traditional way of getting help</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#tidyverse"><i class="fa fa-check"></i><b>3.4</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#tidyverse-basics"><i class="fa fa-check"></i><b>3.4.1</b> Tidyverse basics</a></li>
<li class="chapter" data-level="3.4.2" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#pipes"><i class="fa fa-check"></i><b>3.4.2</b> Pipes</a></li>
<li class="chapter" data-level="3.4.3" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#tibbles"><i class="fa fa-check"></i><b>3.4.3</b> Tibbles</a></li>
<li class="chapter" data-level="3.4.4" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#differences-between-tibbles-and-data.frames"><i class="fa fa-check"></i><b>3.4.4</b> Differences between tibbles and data.frames</a></li>
<li class="chapter" data-level="3.4.5" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#tidyverse-tools"><i class="fa fa-check"></i><b>3.4.5</b> Tidyverse tools</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#final-exercise-1"><i class="fa fa-check"></i><b>3.5</b> Final exercise</a></li>
<li class="chapter" data-level="3.6" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#bonus-r-markdown"><i class="fa fa-check"></i><b>3.6</b> Bonus: R Markdown</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="introduction-to-r-part-2.html"><a href="introduction-to-r-part-2.html#how-does-the-r-markdown-work"><i class="fa fa-check"></i><b>3.6.1</b> How does the R Markdown work?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>4</b> Summarizing Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="summarizing-data.html"><a href="summarizing-data.html#are-you-ready"><i class="fa fa-check"></i><b>4.1</b> Are you ready?</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="summarizing-data.html"><a href="summarizing-data.html#wait-you-guys-are-getting-results"><i class="fa fa-check"></i><b>4.1.1</b> Wait… you guys are getting results???!</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="summarizing-data.html"><a href="summarizing-data.html#packages-1"><i class="fa fa-check"></i><b>4.2</b> Packages</a></li>
<li class="chapter" data-level="4.3" data-path="summarizing-data.html"><a href="summarizing-data.html#numerical-methods"><i class="fa fa-check"></i><b>4.3</b> Numerical methods</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="summarizing-data.html"><a href="summarizing-data.html#peabody-data"><i class="fa fa-check"></i><b>4.3.1</b> Peabody data</a></li>
<li class="chapter" data-level="4.3.2" data-path="summarizing-data.html"><a href="summarizing-data.html#central-tendency"><i class="fa fa-check"></i><b>4.3.2</b> Central tendency</a></li>
<li class="chapter" data-level="4.3.3" data-path="summarizing-data.html"><a href="summarizing-data.html#variability"><i class="fa fa-check"></i><b>4.3.3</b> Variability</a></li>
<li class="chapter" data-level="4.3.4" data-path="summarizing-data.html"><a href="summarizing-data.html#skewness"><i class="fa fa-check"></i><b>4.3.4</b> Skewness</a></li>
<li class="chapter" data-level="4.3.5" data-path="summarizing-data.html"><a href="summarizing-data.html#kurtosis"><i class="fa fa-check"></i><b>4.3.5</b> Kurtosis</a></li>
<li class="chapter" data-level="4.3.6" data-path="summarizing-data.html"><a href="summarizing-data.html#using-the-tidyverse-package"><i class="fa fa-check"></i><b>4.3.6</b> Using the tidyverse package</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="summarizing-data.html"><a href="summarizing-data.html#visual-methods"><i class="fa fa-check"></i><b>4.4</b> Visual methods</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="summarizing-data.html"><a href="summarizing-data.html#using-the-tidyverse-package-1"><i class="fa fa-check"></i><b>4.4.1</b> Using the tidyverse package</a></li>
<li class="chapter" data-level="4.4.2" data-path="summarizing-data.html"><a href="summarizing-data.html#boxplot"><i class="fa fa-check"></i><b>4.4.2</b> Boxplot</a></li>
<li class="chapter" data-level="4.4.3" data-path="summarizing-data.html"><a href="summarizing-data.html#histograms"><i class="fa fa-check"></i><b>4.4.3</b> Histograms</a></li>
<li class="chapter" data-level="4.4.4" data-path="summarizing-data.html"><a href="summarizing-data.html#bar-charts"><i class="fa fa-check"></i><b>4.4.4</b> Bar charts</a></li>
<li class="chapter" data-level="4.4.5" data-path="summarizing-data.html"><a href="summarizing-data.html#scatterplots"><i class="fa fa-check"></i><b>4.4.5</b> Scatterplots</a></li>
<li class="chapter" data-level="4.4.6" data-path="summarizing-data.html"><a href="summarizing-data.html#important-points-about-data-visualization"><i class="fa fa-check"></i><b>4.4.6</b> Important points about data visualization</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="summarizing-data.html"><a href="summarizing-data.html#final-exercise-2"><i class="fa fa-check"></i><b>4.5</b> Final exercise</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regression-and-anova.html"><a href="regression-and-anova.html"><i class="fa fa-check"></i><b>5</b> Regression and ANOVA</a>
<ul>
<li class="chapter" data-level="5.1" data-path="regression-and-anova.html"><a href="regression-and-anova.html#your-first-ph.d.-statistics-course-is-almost-done"><i class="fa fa-check"></i><b>5.1</b> Your first Ph.D. statistics course is almost done</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="regression-and-anova.html"><a href="regression-and-anova.html#regression-vs.-anova"><i class="fa fa-check"></i><b>5.1.1</b> Regression vs. ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="regression-and-anova.html"><a href="regression-and-anova.html#what-do-we-do-today"><i class="fa fa-check"></i><b>5.2</b> What Do We Do Today?</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="regression-and-anova.html"><a href="regression-and-anova.html#goals"><i class="fa fa-check"></i><b>5.2.1</b> Goals</a></li>
<li class="chapter" data-level="5.2.2" data-path="regression-and-anova.html"><a href="regression-and-anova.html#packages-2"><i class="fa fa-check"></i><b>5.2.2</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="regression-and-anova.html"><a href="regression-and-anova.html#one-way-anova"><i class="fa fa-check"></i><b>5.3</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="regression-and-anova.html"><a href="regression-and-anova.html#assumptions"><i class="fa fa-check"></i><b>5.3.1</b> Assumptions</a></li>
<li class="chapter" data-level="5.3.2" data-path="regression-and-anova.html"><a href="regression-and-anova.html#analysis"><i class="fa fa-check"></i><b>5.3.2</b> Analysis</a></li>
<li class="chapter" data-level="5.3.3" data-path="regression-and-anova.html"><a href="regression-and-anova.html#can-you-explain-to-me-how-those-results-have-been-obtained"><i class="fa fa-check"></i><b>5.3.3</b> Can you explain to me how those results have been obtained?</a></li>
<li class="chapter" data-level="5.3.4" data-path="regression-and-anova.html"><a href="regression-and-anova.html#how-can-we-interpret-the-results"><i class="fa fa-check"></i><b>5.3.4</b> How can we interpret the results?</a></li>
<li class="chapter" data-level="5.3.5" data-path="regression-and-anova.html"><a href="regression-and-anova.html#given-the-results-we-are-now-interested-in-testing-the-differences-among-all-the-pairs-of-the-means.-because-using-multiple-t-tests-can-inflate-familywise-error-rates-we-will-use-one-of-the-correction-methods.-what-should-we-do"><i class="fa fa-check"></i><b>5.3.5</b> Given the results, we are now interested in testing the differences among all the pairs of the means. Because using multiple t-tests can inflate familywise error rates, we will use one of the correction methods. What should we do?</a></li>
<li class="chapter" data-level="5.3.6" data-path="regression-and-anova.html"><a href="regression-and-anova.html#something-more-about-a-priori-contrasts-and-post-hoc-comparison"><i class="fa fa-check"></i><b>5.3.6</b> Something more about a priori contrasts and post-hoc comparison</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="regression-and-anova.html"><a href="regression-and-anova.html#factorial-anova"><i class="fa fa-check"></i><b>5.4</b> Factorial ANOVA</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="regression-and-anova.html"><a href="regression-and-anova.html#how-can-we-characterize-this-design"><i class="fa fa-check"></i><b>5.4.1</b> How can we characterize this design?</a></li>
<li class="chapter" data-level="5.4.2" data-path="regression-and-anova.html"><a href="regression-and-anova.html#cells-means-for-the-data"><i class="fa fa-check"></i><b>5.4.2</b> Cells means for the data</a></li>
<li class="chapter" data-level="5.4.3" data-path="regression-and-anova.html"><a href="regression-and-anova.html#visualizing-cell-means"><i class="fa fa-check"></i><b>5.4.3</b> Visualizing cell means</a></li>
<li class="chapter" data-level="5.4.4" data-path="regression-and-anova.html"><a href="regression-and-anova.html#analysis-1"><i class="fa fa-check"></i><b>5.4.4</b> Analysis</a></li>
<li class="chapter" data-level="5.4.5" data-path="regression-and-anova.html"><a href="regression-and-anova.html#can-you-explain-to-me-how-those-results-have-been-obtained-1"><i class="fa fa-check"></i><b>5.4.5</b> Can you explain to me how those results have been obtained?</a></li>
<li class="chapter" data-level="5.4.6" data-path="regression-and-anova.html"><a href="regression-and-anova.html#how-can-we-interpret-the-results-1"><i class="fa fa-check"></i><b>5.4.6</b> How can we interpret the results?</a></li>
<li class="chapter" data-level="5.4.7" data-path="regression-and-anova.html"><a href="regression-and-anova.html#what-to-do-with-the-interaction-effect"><i class="fa fa-check"></i><b>5.4.7</b> What to do with the interaction effect?</a></li>
<li class="chapter" data-level="5.4.8" data-path="regression-and-anova.html"><a href="regression-and-anova.html#this-time-lets-use-pairwise-comparison-with-tukeys-hsd-to-elaborate-on-the-results-of-f."><i class="fa fa-check"></i><b>5.4.8</b> This time, let’s use pairwise comparison with Tukey’s HSD to elaborate on the results of F.</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="regression-and-anova.html"><a href="regression-and-anova.html#regression-analysis"><i class="fa fa-check"></i><b>5.5</b> Regression analysis</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="regression-and-anova.html"><a href="regression-and-anova.html#simple-regression-analysis"><i class="fa fa-check"></i><b>5.5.1</b> Simple regression analysis</a></li>
<li class="chapter" data-level="5.5.2" data-path="regression-and-anova.html"><a href="regression-and-anova.html#multiple-regression-analysis"><i class="fa fa-check"></i><b>5.5.2</b> Multiple regression analysis</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">[PSY202A Lab] Statistical Modeling in Psychological Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression-and-anova" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Regression and ANOVA<a href="regression-and-anova.html#regression-and-anova" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="your-first-ph.d.-statistics-course-is-almost-done" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Your first Ph.D. statistics course is almost done<a href="regression-and-anova.html#your-first-ph.d.-statistics-course-is-almost-done" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Keep up the excellent work! You’re nearly there!</li>
</ul>
<p><img src="img/nopsy202a.png" /></p>
<div id="regression-vs.-anova" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Regression vs. ANOVA<a href="regression-and-anova.html#regression-vs.-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="img/regression_anova_meme.png" /></p>
<ul>
<li><p>In general, remember that both regression and ANOVA are part of the broader class of general linear models.</p></li>
<li><p>The term ‘general linear model’ refers to conventional linear regression models for a continuous response variable given continuous and/or categorical predictors.</p>
<ul>
<li><p>For your information, the term ‘generalized linear model’ refers to a larger class of models that is assumed to follow an exponential family distribution. See <a href="https://online.stat.psu.edu/stat504/lesson/6/6.1" class="uri">https://online.stat.psu.edu/stat504/lesson/6/6.1</a>.</p></li>
<li><p>For your additional information, the term ‘generalized linear mixed model’ refers to an even further extension of general linear models that permis random effects as well as fixed effects in the linear predictor. See <a href="https://online.stat.psu.edu/stat504/lesson/generalized-linear-mixed-models" class="uri">https://online.stat.psu.edu/stat504/lesson/generalized-linear-mixed-models</a>.</p></li>
</ul></li>
<li><p>Out of curiosity… are you familiar with ANCOVA…?</p></li>
</ul>
</div>
</div>
<div id="what-do-we-do-today" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> What Do We Do Today?<a href="regression-and-anova.html#what-do-we-do-today" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="goals" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Goals<a href="regression-and-anova.html#goals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>HW7 (one-way ANOVA) and HW8 (factorial ANOVA) are upcoming. Therefore, we will first discuss ANOVA, focusing on helping you succeed with these assignments.</p></li>
<li><p>We will also discuss regression analysis. Let’s approach it with a relaxed and review-oriented mindset.</p></li>
</ul>
</div>
<div id="packages-2" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Packages<a href="regression-and-anova.html#packages-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Initial setting</li>
</ul>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="regression-and-anova.html#cb108-1" tabindex="-1"></a><span class="co"># Clean the workspace</span></span>
<span id="cb108-2"><a href="regression-and-anova.html#cb108-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>());<span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger  (Mb) limit (Mb) max used  (Mb)
## Ncells 1468454 78.5    2241401 119.8         NA  2241401 119.8
## Vcells 2555545 19.5    8388608  64.0      16384  3700917  28.3</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="regression-and-anova.html#cb110-1" tabindex="-1"></a><span class="co"># Set the working directory</span></span>
<span id="cb110-2"><a href="regression-and-anova.html#cb110-2" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;/Users/ihnwhiheo/Github/PSY202A_Modeling&quot;</span>)</span>
<span id="cb110-3"><a href="regression-and-anova.html#cb110-3" tabindex="-1"></a><span class="fu">getwd</span>()</span></code></pre></div>
<pre><code>## [1] &quot;/Users/ihnwhiheo/Github/PSY202A_Modeling&quot;</code></pre>
<ul>
<li>Let’s load R packages that will be used throughout.</li>
</ul>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="regression-and-anova.html#cb112-1" tabindex="-1"></a><span class="co"># List of packages</span></span>
<span id="cb112-2"><a href="regression-and-anova.html#cb112-2" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;psych&quot;</span>, <span class="st">&quot;QuantPsyc&quot;</span>, <span class="st">&quot;car&quot;</span>, <span class="st">&quot;apaTables&quot;</span>, <span class="st">&quot;report&quot;</span>, <span class="st">&quot;multcomp&quot;</span>,</span>
<span id="cb112-3"><a href="regression-and-anova.html#cb112-3" tabindex="-1"></a>              <span class="st">&quot;palmerpenguins&quot;</span>, <span class="st">&quot;tidyverse&quot;</span>, <span class="st">&quot;ggformula&quot;</span>, <span class="st">&quot;emmeans&quot;</span>) <span class="co"># Add the package names you need</span></span>
<span id="cb112-4"><a href="regression-and-anova.html#cb112-4" tabindex="-1"></a></span>
<span id="cb112-5"><a href="regression-and-anova.html#cb112-5" tabindex="-1"></a><span class="co"># Check, install, and load each package</span></span>
<span id="cb112-6"><a href="regression-and-anova.html#cb112-6" tabindex="-1"></a><span class="cf">for</span> (package_name <span class="cf">in</span> packages) {</span>
<span id="cb112-7"><a href="regression-and-anova.html#cb112-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(package_name, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb112-8"><a href="regression-and-anova.html#cb112-8" tabindex="-1"></a>    <span class="fu">install.packages</span>(package_name, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb112-9"><a href="regression-and-anova.html#cb112-9" tabindex="-1"></a>  }</span>
<span id="cb112-10"><a href="regression-and-anova.html#cb112-10" tabindex="-1"></a>  <span class="fu">library</span>(package_name, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb112-11"><a href="regression-and-anova.html#cb112-11" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning: package &#39;ggformula&#39; was built under R version 4.2.3</code></pre>
<pre><code>## Warning: package &#39;scales&#39; was built under R version 4.2.3</code></pre>
<pre><code>## Warning: package &#39;ggridges&#39; was built under R version 4.2.3</code></pre>
<ul>
<li>We will be using with the <code>sat.act</code> dataset in the R <code>psych</code> package.
<ul>
<li>The dataset consists of self-reported scores of 700 subjects on the SAT Verbal, SAT Quantitative and ACT. Additional variables include age, gender (0=female, 1=male), and education ().</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="regression-and-anova.html#cb116-1" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb116-2"><a href="regression-and-anova.html#cb116-2" tabindex="-1"></a><span class="fu">data</span>(sat.act)</span>
<span id="cb116-3"><a href="regression-and-anova.html#cb116-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> sat.act</span></code></pre></div>
<ul>
<li><p>In the original dataset, gender is coded as 1 for males and 2 for females.</p></li>
<li><p>The education variable is categorical, ranging from 1 (high school) to 5 (graduate work). For the variables coded as 0, I could not find the exact coding scheme, so we assume that 0 refers to no education.</p></li>
<li><p>While the other variables are continuous and require no data preprocessing, we will perform some quick data engineering for gender and education.</p></li>
<li><p>Specifically, we will recode gender so that females (originally coded as 2) become the reference category by assigning them a value of 0. Additionally, we will treat the education variable as categorical.</p></li>
</ul>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="regression-and-anova.html#cb117-1" tabindex="-1"></a><span class="co"># Data engineering</span></span>
<span id="cb117-2"><a href="regression-and-anova.html#cb117-2" tabindex="-1"></a>dat<span class="sc">$</span>gender_original <span class="ot">&lt;-</span> dat<span class="sc">$</span>gender</span>
<span id="cb117-3"><a href="regression-and-anova.html#cb117-3" tabindex="-1"></a>dat<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>gender <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb117-4"><a href="regression-and-anova.html#cb117-4" tabindex="-1"></a>dat<span class="sc">$</span>education <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dat<span class="sc">$</span>education)</span>
<span id="cb117-5"><a href="regression-and-anova.html#cb117-5" tabindex="-1"></a></span>
<span id="cb117-6"><a href="regression-and-anova.html#cb117-6" tabindex="-1"></a><span class="co"># Quick overview of the data</span></span>
<span id="cb117-7"><a href="regression-and-anova.html#cb117-7" tabindex="-1"></a><span class="fu">head</span>(dat, <span class="dv">20</span>)</span></code></pre></div>
<pre><code>##       gender education age ACT SATV SATQ gender_original
## 29442      0         3  19  24  500  500               2
## 29457      0         3  23  35  600  500               2
## 29498      0         3  20  21  480  470               2
## 29503      1         4  27  26  550  520               1
## 29504      1         2  33  31  600  550               1
## 29518      1         5  26  28  640  640               1
## 29527      0         5  30  36  610  500               2
## 29529      1         3  19  22  520  560               1
## 29543      0         4  23  22  400  600               2
## 29547      0         5  40  35  730  800               2
## 29578      1         3  23  32  760  710               1
## 29592      0         4  34  29  710  600               2
## 29617      1         4  32  21  600  600               1
## 29619      0         4  41  35  780  725               2
## 29633      0         3  20  27  640  630               2
## 29671      0         4  24  27  640  590               2
## 29676      0         3  19  33  640  650               2
## 29685      0         4  24  32  700  620               2
## 29710      1         4  35  28  640  580               1
## 29711      0         4  46  32  610  680               2</code></pre>
<ul>
<li>Shall we look at the descriptive statistics?</li>
</ul>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="regression-and-anova.html#cb119-1" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb119-2"><a href="regression-and-anova.html#cb119-2" tabindex="-1"></a><span class="fu">describe</span>(dat)</span></code></pre></div>
<pre><code>##                 vars   n   mean     sd median trimmed    mad min max range
## gender             1 700   0.35   0.48      0    0.32   0.00   0   1     1
## education*         2 700   4.16   1.43      4    4.31   1.48   1   6     5
## age                3 700  25.59   9.50     22   23.86   5.93  13  65    52
## ACT                4 700  28.55   4.82     29   28.84   4.45   3  36    33
## SATV               5 700 612.23 112.90    620  619.45 118.61 200 800   600
## SATQ               6 687 610.22 115.64    620  617.25 118.61 200 800   600
## gender_original    7 700   1.65   0.48      2    1.68   0.00   1   2     1
##                  skew kurtosis   se
## gender           0.61    -1.62 0.02
## education*      -0.68    -0.07 0.05
## age              1.64     2.42 0.36
## ACT             -0.66     0.53 0.18
## SATV            -0.64     0.33 4.27
## SATQ            -0.59    -0.02 4.41
## gender_original -0.61    -1.62 0.02</code></pre>
<ul>
<li>For categorical variables (i.e., gender and education), let’s make a table and view the frequencies.</li>
</ul>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="regression-and-anova.html#cb121-1" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb121-2"><a href="regression-and-anova.html#cb121-2" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Gender =</span> dat<span class="sc">$</span>gender, <span class="at">Education =</span> dat<span class="sc">$</span>education)</span>
<span id="cb121-3"><a href="regression-and-anova.html#cb121-3" tabindex="-1"></a><span class="fu">addmargins</span>(tab)</span></code></pre></div>
<pre><code>##       Education
## Gender   0   1   2   3   4   5 Sum
##    0    30  25  21 195  87  95 453
##    1    27  20  23  80  51  46 247
##    Sum  57  45  44 275 138 141 700</code></pre>
</div>
</div>
<div id="one-way-anova" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> One-way ANOVA<a href="regression-and-anova.html#one-way-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="assumptions" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Assumptions<a href="regression-and-anova.html#assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Trailer: You will literally enjoy assumptions in PSY202B with Sarah!</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>Normality: We assume that the populations from which the samples were taken are normally distributed.</li>
</ol>
<ul>
<li>Numerically, we can check the skewness and kurtosis of the variables. For instance,</li>
</ul>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="regression-and-anova.html#cb123-1" tabindex="-1"></a><span class="co"># Skewness and kurtosis</span></span>
<span id="cb123-2"><a href="regression-and-anova.html#cb123-2" tabindex="-1"></a><span class="fu">skew</span>(dat<span class="sc">$</span>ACT) <span class="co"># Little bit negatively skewed (if 0, no skew; if positive, positively skewed)</span></span></code></pre></div>
<pre><code>## [1] -0.6564026</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="regression-and-anova.html#cb125-1" tabindex="-1"></a><span class="fu">kurtosi</span>(dat<span class="sc">$</span>ACT) <span class="co"># Little bit leptokurtic (if 0, mesokurti;, if negative, platykurtic)</span></span></code></pre></div>
<pre><code>## [1] 0.5349691</code></pre>
<ul>
<li>Visually, we can check the QQ plot. For instance:</li>
</ul>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="regression-and-anova.html#cb127-1" tabindex="-1"></a><span class="co"># QQ plot</span></span>
<span id="cb127-2"><a href="regression-and-anova.html#cb127-2" tabindex="-1"></a><span class="fu">qqnorm</span>(dat<span class="sc">$</span>ACT)</span>
<span id="cb127-3"><a href="regression-and-anova.html#cb127-3" tabindex="-1"></a><span class="fu">qqline</span>(dat<span class="sc">$</span>ACT)</span></code></pre></div>
<p><img src="PSY202A-Modeling-I.Heo_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
<ul>
<li>Or simply we can check the histogram.</li>
</ul>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="regression-and-anova.html#cb128-1" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb128-2"><a href="regression-and-anova.html#cb128-2" tabindex="-1"></a><span class="fu">hist</span>(dat<span class="sc">$</span>ACT)</span></code></pre></div>
<p><img src="PSY202A-Modeling-I.Heo_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
<ul>
<li>Or we can examine the density plot to compare the distribution of the variable against the ideal normal distribution.</li>
</ul>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="regression-and-anova.html#cb129-1" tabindex="-1"></a><span class="co"># Density plot</span></span>
<span id="cb129-2"><a href="regression-and-anova.html#cb129-2" tabindex="-1"></a><span class="fu">plotNormX</span>(dat<span class="sc">$</span>ACT)</span></code></pre></div>
<p><img src="PSY202A-Modeling-I.Heo_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Random sampling: We assume that the data we measure were obtained from a sample that we selected using a random sampling procedure.</li>
</ol>
<ul>
<li>We cannot statistically test whether random sampling has occurred. Think about the data collection method you used.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Independence: We assume that the probabilities of each measured outcome in a study are independent or equal.</li>
</ol>
<ul>
<li>For the independence assumption, we cannot test this statistically. Just think about the data collection method you used.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Homogeneity of variance (i.e., homoscedasticity): We assume that the samples were drawn from populations of equal variances.</li>
</ol>
<ul>
<li><p>Numerically, we can conduct Barlett’s or Levene’s test.</p>
<ul>
<li>If significant, the assumption of homogeneity of variances is violated.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="regression-and-anova.html#cb130-1" tabindex="-1"></a><span class="co"># Bartlett&#39;s test</span></span>
<span id="cb130-2"><a href="regression-and-anova.html#cb130-2" tabindex="-1"></a><span class="fu">bartlett.test</span>(ACT <span class="sc">~</span> gender, <span class="at">data =</span> dat)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  ACT by gender
## Bartlett&#39;s K-squared = 1.9164, df = 1, p-value = 0.1663</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="regression-and-anova.html#cb132-1" tabindex="-1"></a><span class="fu">bartlett.test</span>(ACT <span class="sc">~</span> education, <span class="at">data =</span> dat)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  ACT by education
## Bartlett&#39;s K-squared = 21.624, df = 5, p-value = 0.0006172</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="regression-and-anova.html#cb134-1" tabindex="-1"></a><span class="co"># Levene&#39;s test</span></span>
<span id="cb134-2"><a href="regression-and-anova.html#cb134-2" tabindex="-1"></a><span class="fu">leveneTest</span>(dat<span class="sc">$</span>ACT, <span class="at">group =</span> dat<span class="sc">$</span>gender)</span></code></pre></div>
<pre><code>## Warning in leveneTest.default(dat$ACT, group = dat$gender): dat$gender coerced
## to factor.</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##        Df F value Pr(&gt;F)
## group   1  0.2899 0.5904
##       698</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="regression-and-anova.html#cb137-1" tabindex="-1"></a><span class="fu">leveneTest</span>(dat<span class="sc">$</span>ACT, <span class="at">group =</span> dat<span class="sc">$</span>education)</span></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##        Df F value   Pr(&gt;F)   
## group   5   3.279 0.006194 **
##       694                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<ul>
<li>Visually, we can look at the box plots</li>
</ul>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="regression-and-anova.html#cb139-1" tabindex="-1"></a><span class="co"># Boxplots</span></span>
<span id="cb139-2"><a href="regression-and-anova.html#cb139-2" tabindex="-1"></a><span class="fu">boxplot</span>(ACT <span class="sc">~</span> gender, <span class="at">data =</span> dat)</span></code></pre></div>
<p><img src="PSY202A-Modeling-I.Heo_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="regression-and-anova.html#cb140-1" tabindex="-1"></a><span class="fu">boxplot</span>(ACT <span class="sc">~</span> education, <span class="at">data =</span> dat)</span></code></pre></div>
<p><img src="PSY202A-Modeling-I.Heo_files/figure-html/unnamed-chunk-94-2.png" width="672" /></p>
</div>
<div id="analysis" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Analysis<a href="regression-and-anova.html#analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Let’s conduct a one-way ANOVA to test whether there are significant mean differences in ACT scores across the different education levels.</li>
</ul>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="regression-and-anova.html#cb141-1" tabindex="-1"></a><span class="co"># Perform a one-way ANOVA</span></span>
<span id="cb141-2"><a href="regression-and-anova.html#cb141-2" tabindex="-1"></a>model_oaov <span class="ot">&lt;-</span> <span class="fu">aov</span>(ACT <span class="sc">~</span> education, <span class="at">data =</span> dat)</span>
<span id="cb141-3"><a href="regression-and-anova.html#cb141-3" tabindex="-1"></a></span>
<span id="cb141-4"><a href="regression-and-anova.html#cb141-4" tabindex="-1"></a><span class="co"># Print the output</span></span>
<span id="cb141-5"><a href="regression-and-anova.html#cb141-5" tabindex="-1"></a><span class="fu">summary</span>(model_oaov)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## education     5    470   93.90   4.126 0.00106 **
## Residuals   694  15794   22.76                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="regression-and-anova.html#cb143-1" tabindex="-1"></a><span class="co"># Make the APA-style table</span></span>
<span id="cb143-2"><a href="regression-and-anova.html#cb143-2" tabindex="-1"></a><span class="fu">apa.aov.table</span>(model_oaov)</span></code></pre></div>
<pre><code>## 
## 
## ANOVA results using ACT as the dependent variable
##  
## 
##    Predictor       SS  df       MS       F    p partial_eta2 CI_90_partial_eta2
##  (Intercept) 43023.79   1 43023.79 1890.50 .000                                
##    education   469.50   5    93.90    4.13 .001          .03         [.01, .05]
##        Error 15793.94 694    22.76                                             
## 
## Note: Values in square brackets indicate the bounds of the 90% confidence interval for partial eta-squared</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="regression-and-anova.html#cb145-1" tabindex="-1"></a><span class="co"># Describe the result following the APA-style; but for reference ONLY!</span></span>
<span id="cb145-2"><a href="regression-and-anova.html#cb145-2" tabindex="-1"></a><span class="fu">report</span>(model_oaov)</span></code></pre></div>
<pre><code>## The ANOVA (formula: ACT ~ education) suggests that:
## 
##   - The main effect of education is statistically significant and small (F(5,
## 694) = 4.13, p = 0.001; Eta2 = 0.03, 95% CI [7.33e-03, 1.00])
## 
## Effect sizes were labelled following Field&#39;s (2013) recommendations.</code></pre>
</div>
<div id="can-you-explain-to-me-how-those-results-have-been-obtained" class="section level3 hasAnchor" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Can you explain to me how those results have been obtained?<a href="regression-and-anova.html#can-you-explain-to-me-how-those-results-have-been-obtained" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>I’ll leave this as food for thought for you!</li>
</ul>
</div>
<div id="how-can-we-interpret-the-results" class="section level3 hasAnchor" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> How can we interpret the results?<a href="regression-and-anova.html#how-can-we-interpret-the-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>According to the ANOVA summary table, the omnibus F-test is statistically significant, as the p-value is below the alpha level of 0.05. This indicates that the null hypothesis of equal population means across the six education groups is rejected. Consequently, we conclude that the six education levels are associated with different ACT scores.</li>
</ul>
</div>
<div id="given-the-results-we-are-now-interested-in-testing-the-differences-among-all-the-pairs-of-the-means.-because-using-multiple-t-tests-can-inflate-familywise-error-rates-we-will-use-one-of-the-correction-methods.-what-should-we-do" class="section level3 hasAnchor" number="5.3.5">
<h3><span class="header-section-number">5.3.5</span> Given the results, we are now interested in testing the differences among all the pairs of the means. Because using multiple t-tests can inflate familywise error rates, we will use one of the correction methods. What should we do?<a href="regression-and-anova.html#given-the-results-we-are-now-interested-in-testing-the-differences-among-all-the-pairs-of-the-means.-because-using-multiple-t-tests-can-inflate-familywise-error-rates-we-will-use-one-of-the-correction-methods.-what-should-we-do" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Note that Bonferroni and Holm-Bonferroni are a priori comparison methods. This means they are used when we have a planned set of comparisons before collecting data.
<ul>
<li>In our case, we did not have such a plan (or did you have something in mind? If then, you are amazing!). Therefore, we will use either Fisher’s LSD or Tukey’s HSD for post hoc comparisons.</li>
</ul></li>
<li>Fisher’s LSD is typically used when there are only three means to compare. This is because, with three means, the family-wise error rate remains controlled at the significance level of alpha.
<ul>
<li>However, when comparing more than three means, the overall F-test does not adequately protect the family-wise error rate if the complete null hypothesis is not true but a subset of it is.</li>
</ul></li>
<li>Tukey’s HSD, on the other hand, is specifically designed to perform all possible pairwise comparisons. It ensures that the researcher has only a 5% chance of finding a significant mean difference when the null hypothesis is true.
<ul>
<li>In the current example, there are 15 comparisons to be made (Can you understand why? If yes, please explain that to me!). Thus, Tukey’s HSD is the appropriate method among the four correction techniques.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="regression-and-anova.html#cb147-1" tabindex="-1"></a><span class="co"># Tukey&#39;s HSD</span></span>
<span id="cb147-2"><a href="regression-and-anova.html#cb147-2" tabindex="-1"></a><span class="fu">TukeyHSD</span>(model_oaov)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = ACT ~ education, data = dat)
## 
## $education
##            diff         lwr      upr     p adj
## 1-0  0.01520468 -2.70335124 2.733761 1.0000000
## 2-0 -0.49641148 -3.23217649 2.239354 0.9954530
## 3-0  0.82086124 -1.16316374 2.804886 0.8453156
## 4-0  1.78718535 -0.35927170 3.933642 0.1648941
## 5-0  2.12915267 -0.01061924 4.268925 0.0520133
## 2-1 -0.51161616 -3.40192518 2.378693 0.9959541
## 3-1  0.80565657 -1.38656404 2.997877 0.9005816
## 4-1  1.77198068 -0.56826588 4.112227 0.2562269
## 5-1  2.11394799 -0.22016851 4.448064 0.1015015
## 3-2  1.31727273 -0.89625276 3.530798 0.5317982
## 4-2  2.28359684 -0.07661879 4.643812 0.0644453
## 5-2  2.62556415  0.27142658 4.979702 0.0186900
## 4-3  0.96632411 -0.45584423 2.388492 0.3775325
## 5-3  1.30829142 -0.10376689 2.720350 0.0874803
## 5-4  0.34196731 -1.29046383 1.974398 0.9911202</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="regression-and-anova.html#cb149-1" tabindex="-1"></a><span class="co"># Test whether the adjusted p-values are lower than 0.05</span></span>
<span id="cb149-2"><a href="regression-and-anova.html#cb149-2" tabindex="-1"></a><span class="fu">TukeyHSD</span>(model_oaov)<span class="sc">$</span>education[,<span class="dv">4</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span></span></code></pre></div>
<pre><code>##   1-0   2-0   3-0   4-0   5-0   2-1   3-1   4-1   5-1   3-2   4-2   5-2   4-3 
## FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE 
##   5-3   5-4 
## FALSE FALSE</code></pre>
<ul>
<li>The adjusted p-values based on Tukey’s HSD indicate a significant difference when comparing the means of group 2 and group 5. Therefore, the group means for 2 and 5 are significantly different.</li>
</ul>
</div>
<div id="something-more-about-a-priori-contrasts-and-post-hoc-comparison" class="section level3 hasAnchor" number="5.3.6">
<h3><span class="header-section-number">5.3.6</span> Something more about a priori contrasts and post-hoc comparison<a href="regression-and-anova.html#something-more-about-a-priori-contrasts-and-post-hoc-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>For our valuable learning experiences, we can also use other packages for multiple comparisons.</p></li>
<li><p>Let’s start with the usage of the <code>multcomp</code> package.</p></li>
<li><p>The <code>glht</code> function is used to create a test for multiple contrasts. The contrasts can be all-possible pairwise comparisons, which is referred to as “Tukey” in this package. Then, the result of multiple contrasts can be summarized and adjusted for familywise error rate.</p></li>
<li><p>The Bonferroni method is used in this example. Note that if the test argument is not specified, the single-step approach is used. The adjusted p values is computed from the joint normal or t distribution of the z statistics such that the p value represents the probability of getting at least one significant result by chance if all z or t values are the same in all contrasts. The Tukey method and the single-step approach will provide the same results if the group sizes are equal.</p></li>
</ul>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="regression-and-anova.html#cb151-1" tabindex="-1"></a><span class="co"># Multiple comparisons</span></span>
<span id="cb151-2"><a href="regression-and-anova.html#cb151-2" tabindex="-1"></a>pairwise <span class="ot">&lt;-</span> <span class="fu">glht</span>(model_oaov, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">education =</span> <span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb151-3"><a href="regression-and-anova.html#cb151-3" tabindex="-1"></a><span class="fu">summary</span>(pairwise, <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="at">type =</span> <span class="st">&quot;bonferroni&quot;</span>))</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = ACT ~ education, data = dat)
## 
## Linear Hypotheses:
##            Estimate Std. Error t value Pr(&gt;|t|)  
## 1 - 0 == 0   0.0152     0.9513   0.016   1.0000  
## 2 - 0 == 0  -0.4964     0.9573  -0.519   1.0000  
## 3 - 0 == 0   0.8209     0.6943   1.182   1.0000  
## 4 - 0 == 0   1.7872     0.7511   2.379   0.2642  
## 5 - 0 == 0   2.1292     0.7488   2.844   0.0689 .
## 2 - 1 == 0  -0.5116     1.0114  -0.506   1.0000  
## 3 - 1 == 0   0.8057     0.7671   1.050   1.0000  
## 4 - 1 == 0   1.7720     0.8189   2.164   0.4623  
## 5 - 1 == 0   2.1139     0.8168   2.588   0.1478  
## 3 - 2 == 0   1.3173     0.7746   1.701   1.0000  
## 4 - 2 == 0   2.2836     0.8259   2.765   0.0877 .
## 5 - 2 == 0   2.6256     0.8238   3.187   0.0225 *
## 4 - 3 == 0   0.9663     0.4977   1.942   0.7886  
## 5 - 3 == 0   1.3083     0.4941   2.648   0.1243  
## 5 - 4 == 0   0.3420     0.5712   0.599   1.0000  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<ul>
<li>The simultaneous confidence interval can be computed by the <code>confint</code> function:</li>
</ul>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="regression-and-anova.html#cb153-1" tabindex="-1"></a><span class="co"># Confidence interval</span></span>
<span id="cb153-2"><a href="regression-and-anova.html#cb153-2" tabindex="-1"></a><span class="fu">confint</span>(pairwise)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Confidence Intervals
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = ACT ~ education, data = dat)
## 
## Quantile = 2.8307
## 95% family-wise confidence level
##  
## 
## Linear Hypotheses:
##            Estimate  lwr       upr      
## 1 - 0 == 0  0.015205 -2.677683  2.708092
## 2 - 0 == 0 -0.496411 -3.206346  2.213523
## 3 - 0 == 0  0.820861 -1.144431  2.786153
## 4 - 0 == 0  1.787185 -0.339005  3.913376
## 5 - 0 == 0  2.129153  0.009584  4.248721
## 2 - 1 == 0 -0.511616 -3.374635  2.351403
## 3 - 1 == 0  0.805657 -1.365865  2.977179
## 4 - 1 == 0  1.771981 -0.546170  4.090131
## 5 - 1 == 0  2.113948 -0.198130  4.426026
## 3 - 2 == 0  1.317273 -0.875353  3.509898
## 4 - 2 == 0  2.283597 -0.054334  4.621528
## 5 - 2 == 0  2.625564  0.293654  4.957474
## 4 - 3 == 0  0.966324 -0.442416  2.375065
## 5 - 3 == 0  1.308291 -0.090434  2.707017
## 5 - 4 == 0  0.341967 -1.275051  1.958985</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="regression-and-anova.html#cb155-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">confint</span>(pairwise))</span></code></pre></div>
<p><img src="PSY202A-Modeling-I.Heo_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<ul>
<li>Instead of post hoc comparison, researchers may have a priori contrasts from their research hypotheses. For example, researchers expect a linear trend in the impact of education on ACT score. The contrast coefficient of the linear trend for six groups can be created:</li>
</ul>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="regression-and-anova.html#cb156-1" tabindex="-1"></a><span class="co"># Contrast</span></span>
<span id="cb156-2"><a href="regression-and-anova.html#cb156-2" tabindex="-1"></a>ctr <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="sc">-</span><span class="fl">1.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>), <span class="dv">1</span>, <span class="dv">6</span>)</span></code></pre></div>
<ul>
<li>The polynomial contrast coefficient is based on Table A10 in Maxwell and Delaney (2004). The contrast is specified in a matrix where rows represent different contrasts and columns represent the coefficient of each group. The contrast can be evaluated using the glht function from the <code>multcomp</code> package:</li>
</ul>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="regression-and-anova.html#cb157-1" tabindex="-1"></a><span class="co"># Simultanoues tests for general linear hypotheses</span></span>
<span id="cb157-2"><a href="regression-and-anova.html#cb157-2" tabindex="-1"></a>linear <span class="ot">&lt;-</span> <span class="fu">glht</span>(model_oaov, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">education =</span> ctr))</span>
<span id="cb157-3"><a href="regression-and-anova.html#cb157-3" tabindex="-1"></a><span class="fu">summary</span>(linear)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: User-defined Contrasts
## 
## 
## Fit: aov(formula = ACT ~ education, data = dat)
## 
## Linear Hypotheses:
##        Estimate Std. Error t value Pr(&gt;|t|)    
## 1 == 0    8.639      2.272   3.802 0.000156 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<ul>
<li><p>The contrast is provided in the <code>linfct</code> argument. Because only one contrast is tested, the familywise error rate correction is not needed.</p></li>
<li><p>Next, all polynomial contrasts up to the fifth order are investigated for the difference in ACT between education levels:</p></li>
</ul>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="regression-and-anova.html#cb159-1" tabindex="-1"></a><span class="co"># Different contrasts as examples</span></span>
<span id="cb159-2"><a href="regression-and-anova.html#cb159-2" tabindex="-1"></a>linear <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb159-3"><a href="regression-and-anova.html#cb159-3" tabindex="-1"></a>quadratic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb159-4"><a href="regression-and-anova.html#cb159-4" tabindex="-1"></a>cubic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">7</span>, <span class="dv">5</span>)</span>
<span id="cb159-5"><a href="regression-and-anova.html#cb159-5" tabindex="-1"></a>quartic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb159-6"><a href="regression-and-anova.html#cb159-6" tabindex="-1"></a>quintic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb159-7"><a href="regression-and-anova.html#cb159-7" tabindex="-1"></a>mctr <span class="ot">&lt;-</span> <span class="fu">rbind</span>(linear, quadratic, cubic, quartic, quintic)</span></code></pre></div>
<ul>
<li>As mentioned above, the row of the contrast matrix represents different contrasts. The matrix of multiple contrasts can be used in the glht function:</li>
</ul>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="regression-and-anova.html#cb160-1" tabindex="-1"></a><span class="co"># Multiple testing</span></span>
<span id="cb160-2"><a href="regression-and-anova.html#cb160-2" tabindex="-1"></a>polynomial <span class="ot">&lt;-</span> <span class="fu">glht</span>(model_oaov, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">education =</span> mctr))</span>
<span id="cb160-3"><a href="regression-and-anova.html#cb160-3" tabindex="-1"></a><span class="fu">summary</span>(polynomial, <span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type =</span> <span class="st">&quot;bonferroni&quot;</span>))</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: User-defined Contrasts
## 
## 
## Fit: aov(formula = ACT ~ education, data = dat)
## 
## Linear Hypotheses:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## linear == 0      17.279      4.544   3.802  0.00078 ***
## quadratic == 0    7.546      4.928   1.531  0.63099    
## cubic == 0       -7.027      7.515  -0.935  1.00000    
## quartic == 0     -2.629      2.999  -0.877  1.00000    
## quintic == 0      6.442      8.793   0.733  1.00000    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="factorial-anova" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Factorial ANOVA<a href="regression-and-anova.html#factorial-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Shall we use a different dataset this time?</li>
</ul>
<p><img src="img/penguines.png" /></p>
<ul>
<li><p>Here, assume we are interested in testing whether there are significant mean differences in body mass across the different species and sex levels.</p></li>
<li><p>There are three different types for the species variable and two levels for the sex variable.</p></li>
</ul>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="regression-and-anova.html#cb162-1" tabindex="-1"></a><span class="co"># Use penguins data</span></span>
<span id="cb162-2"><a href="regression-and-anova.html#cb162-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> penguins</span>
<span id="cb162-3"><a href="regression-and-anova.html#cb162-3" tabindex="-1"></a></span>
<span id="cb162-4"><a href="regression-and-anova.html#cb162-4" tabindex="-1"></a><span class="co"># Quick look at the data</span></span>
<span id="cb162-5"><a href="regression-and-anova.html#cb162-5" tabindex="-1"></a><span class="fu">str</span>(dat)</span></code></pre></div>
<pre><code>## tibble [344 × 8] (S3: tbl_df/tbl/data.frame)
##  $ species          : Factor w/ 3 levels &quot;Adelie&quot;,&quot;Chinstrap&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ island           : Factor w/ 3 levels &quot;Biscoe&quot;,&quot;Dream&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ bill_length_mm   : num [1:344] 39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...
##  $ bill_depth_mm    : num [1:344] 18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...
##  $ flipper_length_mm: int [1:344] 181 186 195 NA 193 190 181 195 193 190 ...
##  $ body_mass_g      : int [1:344] 3750 3800 3250 NA 3450 3650 3625 4675 3475 4250 ...
##  $ sex              : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 2 1 1 NA 1 2 1 2 NA NA ...
##  $ year             : int [1:344] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="regression-and-anova.html#cb164-1" tabindex="-1"></a><span class="fu">describe</span>(dat)</span></code></pre></div>
<pre><code>##                   vars   n    mean     sd  median trimmed    mad    min    max
## species*             1 344    1.92   0.89    2.00    1.90   1.48    1.0    3.0
## island*              2 344    1.66   0.73    2.00    1.58   1.48    1.0    3.0
## bill_length_mm       3 342   43.92   5.46   44.45   43.91   7.04   32.1   59.6
## bill_depth_mm        4 342   17.15   1.97   17.30   17.17   2.22   13.1   21.5
## flipper_length_mm    5 342  200.92  14.06  197.00  200.34  16.31  172.0  231.0
## body_mass_g          6 342 4201.75 801.95 4050.00 4154.01 889.56 2700.0 6300.0
## sex*                 7 333    1.50   0.50    2.00    1.51   0.00    1.0    2.0
## year                 8 344 2008.03   0.82 2008.00 2008.04   1.48 2007.0 2009.0
##                    range  skew kurtosis    se
## species*             2.0  0.16    -1.73  0.05
## island*              2.0  0.61    -0.91  0.04
## bill_length_mm      27.5  0.05    -0.89  0.30
## bill_depth_mm        8.4 -0.14    -0.92  0.11
## flipper_length_mm   59.0  0.34    -1.00  0.76
## body_mass_g       3600.0  0.47    -0.74 43.36
## sex*                 1.0 -0.02    -2.01  0.03
## year                 2.0 -0.05    -1.51  0.04</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="regression-and-anova.html#cb166-1" tabindex="-1"></a><span class="fu">summary</span>(dat)</span></code></pre></div>
<pre><code>##       species          island    bill_length_mm  bill_depth_mm  
##  Adelie   :152   Biscoe   :168   Min.   :32.10   Min.   :13.10  
##  Chinstrap: 68   Dream    :124   1st Qu.:39.23   1st Qu.:15.60  
##  Gentoo   :124   Torgersen: 52   Median :44.45   Median :17.30  
##                                  Mean   :43.92   Mean   :17.15  
##                                  3rd Qu.:48.50   3rd Qu.:18.70  
##                                  Max.   :59.60   Max.   :21.50  
##                                  NA&#39;s   :2       NA&#39;s   :2      
##  flipper_length_mm  body_mass_g       sex           year     
##  Min.   :172.0     Min.   :2700   female:165   Min.   :2007  
##  1st Qu.:190.0     1st Qu.:3550   male  :168   1st Qu.:2007  
##  Median :197.0     Median :4050   NA&#39;s  : 11   Median :2008  
##  Mean   :200.9     Mean   :4202                Mean   :2008  
##  3rd Qu.:213.0     3rd Qu.:4750                3rd Qu.:2009  
##  Max.   :231.0     Max.   :6300                Max.   :2009  
##  NA&#39;s   :2         NA&#39;s   :2</code></pre>
<ul>
<li>For the ease of interpretation and implementation, I excluded penguins where the sex variable is missing:</li>
</ul>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="regression-and-anova.html#cb168-1" tabindex="-1"></a><span class="co"># Data engineering for exclusing cases where sex variable is missing</span></span>
<span id="cb168-2"><a href="regression-and-anova.html#cb168-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex))</span>
<span id="cb168-3"><a href="regression-and-anova.html#cb168-3" tabindex="-1"></a></span>
<span id="cb168-4"><a href="regression-and-anova.html#cb168-4" tabindex="-1"></a><span class="co"># Quick look at the modified data</span></span>
<span id="cb168-5"><a href="regression-and-anova.html#cb168-5" tabindex="-1"></a><span class="fu">str</span>(dat)</span></code></pre></div>
<pre><code>## tibble [333 × 8] (S3: tbl_df/tbl/data.frame)
##  $ species          : Factor w/ 3 levels &quot;Adelie&quot;,&quot;Chinstrap&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ island           : Factor w/ 3 levels &quot;Biscoe&quot;,&quot;Dream&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ bill_length_mm   : num [1:333] 39.1 39.5 40.3 36.7 39.3 38.9 39.2 41.1 38.6 34.6 ...
##  $ bill_depth_mm    : num [1:333] 18.7 17.4 18 19.3 20.6 17.8 19.6 17.6 21.2 21.1 ...
##  $ flipper_length_mm: int [1:333] 181 186 195 193 190 181 195 182 191 198 ...
##  $ body_mass_g      : int [1:333] 3750 3800 3250 3450 3650 3625 4675 3200 3800 4400 ...
##  $ sex              : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 2 1 1 1 2 1 2 1 2 2 ...
##  $ year             : int [1:333] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="regression-and-anova.html#cb170-1" tabindex="-1"></a><span class="fu">describe</span>(dat)</span></code></pre></div>
<pre><code>##                   vars   n    mean     sd median trimmed    mad    min    max
## species*             1 333    1.92   0.89    2.0    1.90   1.48    1.0    3.0
## island*              2 333    1.65   0.71    2.0    1.57   1.48    1.0    3.0
## bill_length_mm       3 333   43.99   5.47   44.5   43.98   6.97   32.1   59.6
## bill_depth_mm        4 333   17.16   1.97   17.3   17.19   2.22   13.1   21.5
## flipper_length_mm    5 333  200.97  14.02  197.0  200.36  16.31  172.0  231.0
## body_mass_g          6 333 4207.06 805.22 4050.0 4159.46 889.56 2700.0 6300.0
## sex*                 7 333    1.50   0.50    2.0    1.51   0.00    1.0    2.0
## year                 8 333 2008.04   0.81 2008.0 2008.05   1.48 2007.0 2009.0
##                    range  skew kurtosis    se
## species*             2.0  0.16    -1.72  0.05
## island*              2.0  0.62    -0.85  0.04
## bill_length_mm      27.5  0.04    -0.90  0.30
## bill_depth_mm        8.4 -0.15    -0.91  0.11
## flipper_length_mm   59.0  0.36    -0.98  0.77
## body_mass_g       3600.0  0.47    -0.75 44.13
## sex*                 1.0 -0.02    -2.01  0.03
## year                 2.0 -0.08    -1.49  0.04</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="regression-and-anova.html#cb172-1" tabindex="-1"></a><span class="fu">summary</span>(dat)</span></code></pre></div>
<pre><code>##       species          island    bill_length_mm  bill_depth_mm  
##  Adelie   :146   Biscoe   :163   Min.   :32.10   Min.   :13.10  
##  Chinstrap: 68   Dream    :123   1st Qu.:39.50   1st Qu.:15.60  
##  Gentoo   :119   Torgersen: 47   Median :44.50   Median :17.30  
##                                  Mean   :43.99   Mean   :17.16  
##                                  3rd Qu.:48.60   3rd Qu.:18.70  
##                                  Max.   :59.60   Max.   :21.50  
##  flipper_length_mm  body_mass_g       sex           year     
##  Min.   :172       Min.   :2700   female:165   Min.   :2007  
##  1st Qu.:190       1st Qu.:3550   male  :168   1st Qu.:2007  
##  Median :197       Median :4050                Median :2008  
##  Mean   :201       Mean   :4207                Mean   :2008  
##  3rd Qu.:213       3rd Qu.:4775                3rd Qu.:2009  
##  Max.   :231       Max.   :6300                Max.   :2009</code></pre>
<div id="how-can-we-characterize-this-design" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> How can we characterize this design?<a href="regression-and-anova.html#how-can-we-characterize-this-design" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>There are two factors in this study. The first factor is species, and the second factor is sex. Species has three levels (Adelie, Chinstrap, and Gentoo), and sex has two levels (female and male). In total, there are six combinations formed by the three levels of species and the two levels of sex, with penguins assigned to all six combinations. This indicates that the current study employs a <span class="math inline">\(3 \times 2\)</span> factorial design. For this design, a two-way ANOVA should be conducted. The three null hypotheses being tested are as follows:</p></li>
<li><p><span class="math inline">\(H_0\)</span> (regarding species): Species does not have a significant main effect on body mass (group means on body mass across the three levels of species are not different).</p></li>
<li><p><span class="math inline">\(H_0\)</span> (regarding sex): Sex does not have a significant main effect on body mass (group means on body mass across the two levels of sex are not different).</p></li>
<li><p><span class="math inline">\(H_0\)</span> (regarding interaction): There is no significant interaction between species and sex on body mass.</p></li>
</ul>
</div>
<div id="cells-means-for-the-data" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Cells means for the data<a href="regression-and-anova.html#cells-means-for-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="regression-and-anova.html#cb174-1" tabindex="-1"></a><span class="co"># Mean by groups in a wide format</span></span>
<span id="cb174-2"><a href="regression-and-anova.html#cb174-2" tabindex="-1"></a>dat.tab <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(species, sex) <span class="sc">%&gt;%</span></span>
<span id="cb174-3"><a href="regression-and-anova.html#cb174-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_bodymass =</span> <span class="fu">mean</span>(body_mass_g)) <span class="sc">%&gt;%</span></span>
<span id="cb174-4"><a href="regression-and-anova.html#cb174-4" tabindex="-1"></a>  <span class="fu">spread</span>(sex, mean_bodymass)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;species&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="regression-and-anova.html#cb176-1" tabindex="-1"></a><span class="co"># Add the marginal means for species</span></span>
<span id="cb176-2"><a href="regression-and-anova.html#cb176-2" tabindex="-1"></a>dat.tab<span class="sc">$</span>Means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(dat.tab[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb176-3"><a href="regression-and-anova.html#cb176-3" tabindex="-1"></a></span>
<span id="cb176-4"><a href="regression-and-anova.html#cb176-4" tabindex="-1"></a><span class="co"># Add the marginal means for sex</span></span>
<span id="cb176-5"><a href="regression-and-anova.html#cb176-5" tabindex="-1"></a>col_means <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">colMeans</span>(dat.tab[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]))</span>
<span id="cb176-6"><a href="regression-and-anova.html#cb176-6" tabindex="-1"></a>dat.tab <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat.tab, col_means)</span>
<span id="cb176-7"><a href="regression-and-anova.html#cb176-7" tabindex="-1"></a>dat.tab<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Adelie&quot;</span>, <span class="st">&quot;Chinstrap&quot;</span>, <span class="st">&quot;Gentoo&quot;</span>, <span class="st">&quot;Means&quot;</span>)</span>
<span id="cb176-8"><a href="regression-and-anova.html#cb176-8" tabindex="-1"></a></span>
<span id="cb176-9"><a href="regression-and-anova.html#cb176-9" tabindex="-1"></a><span class="co"># Print the table</span></span>
<span id="cb176-10"><a href="regression-and-anova.html#cb176-10" tabindex="-1"></a>dat.tab</span></code></pre></div>
<pre><code>## # A tibble: 4 × 4
## # Groups:   species [4]
##   species   female  male Means
##   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Adelie     3369. 4043. 3706.
## 2 Chinstrap  3527. 3939. 3733.
## 3 Gentoo     4680. 5485. 5082.
## 4 Means      3859. 4489. 4174.</code></pre>
<ul>
<li><p>Can you understand the means by groups? In particular:</p>
<ul>
<li><p>Can you find any simple effect? (i.e., the effect of one IV at a specific level of the other IV)</p></li>
<li><p>Can you find any main effect? (i.e., the average effect of the IV across the levels of all other IVs)</p></li>
<li><p>Can you find any interaction effect? (i.e., the simple effects of one IV are not constant across all levels of the other IV; there is a differential effect)</p></li>
</ul></li>
</ul>
</div>
<div id="visualizing-cell-means" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Visualizing cell means<a href="regression-and-anova.html#visualizing-cell-means" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="regression-and-anova.html#cb178-1" tabindex="-1"></a><span class="co"># Jittered scatterplot with mean and SE</span></span>
<span id="cb178-2"><a href="regression-and-anova.html#cb178-2" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb178-3"><a href="regression-and-anova.html#cb178-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb178-4"><a href="regression-and-anova.html#cb178-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sex) <span class="sc">+</span></span>
<span id="cb178-5"><a href="regression-and-anova.html#cb178-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.dat =</span> <span class="st">&quot;mean_se&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>, <span class="at">wide =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb178-6"><a href="regression-and-anova.html#cb178-6" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.dat =</span> <span class="st">&quot;mean_se&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;pointrange&quot;</span>) <span class="sc">+</span></span>
<span id="cb178-7"><a href="regression-and-anova.html#cb178-7" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch =</span> <span class="fl">1.0</span>)</span></code></pre></div>
<pre><code>## Warning in stat_summary(fun.dat = &quot;mean_se&quot;, geom = &quot;errorbar&quot;, wide = 0.5):
## Ignoring unknown parameters: `fun.dat` and `wide`</code></pre>
<pre><code>## Warning in stat_summary(fun.dat = &quot;mean_se&quot;, geom = &quot;pointrange&quot;): Ignoring
## unknown parameters: `fun.dat`</code></pre>
<pre><code>## No summary function supplied, defaulting to `mean_se()`
## No summary function supplied, defaulting to `mean_se()`
## No summary function supplied, defaulting to `mean_se()`
## No summary function supplied, defaulting to `mean_se()`</code></pre>
<p><img src="PSY202A-Modeling-I.Heo_files/figure-html/unnamed-chunk-107-1.png" width="672" /></p>
<ul>
<li>What can you observe from the plot?</li>
</ul>
</div>
<div id="analysis-1" class="section level3 hasAnchor" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> Analysis<a href="regression-and-anova.html#analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s conduct a two-way ANOVA to test whether there are mean differences in body mass across the different species and sex levels.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="regression-and-anova.html#cb182-1" tabindex="-1"></a><span class="co"># Perform a two-way ANOVA</span></span>
<span id="cb182-2"><a href="regression-and-anova.html#cb182-2" tabindex="-1"></a><span class="co"># Both of the code below do the same job</span></span>
<span id="cb182-3"><a href="regression-and-anova.html#cb182-3" tabindex="-1"></a>model_taov <span class="ot">&lt;-</span> <span class="fu">aov</span>(body_mass_g <span class="sc">~</span> species <span class="sc">+</span> sex <span class="sc">+</span> species<span class="sc">:</span>sex, <span class="at">data =</span> dat)</span>
<span id="cb182-4"><a href="regression-and-anova.html#cb182-4" tabindex="-1"></a><span class="do">## The colon represents the interaction effect only</span></span>
<span id="cb182-5"><a href="regression-and-anova.html#cb182-5" tabindex="-1"></a></span>
<span id="cb182-6"><a href="regression-and-anova.html#cb182-6" tabindex="-1"></a>model_taov <span class="ot">&lt;-</span> <span class="fu">aov</span>(body_mass_g <span class="sc">~</span> species<span class="sc">*</span>sex, <span class="at">data =</span> dat)</span>
<span id="cb182-7"><a href="regression-and-anova.html#cb182-7" tabindex="-1"></a><span class="do">## The asterisk represents the interaction effect and the main effect of each variable</span></span>
<span id="cb182-8"><a href="regression-and-anova.html#cb182-8" tabindex="-1"></a><span class="do">## (and all lower-order interactions)</span></span>
<span id="cb182-9"><a href="regression-and-anova.html#cb182-9" tabindex="-1"></a></span>
<span id="cb182-10"><a href="regression-and-anova.html#cb182-10" tabindex="-1"></a><span class="co"># Results</span></span>
<span id="cb182-11"><a href="regression-and-anova.html#cb182-11" tabindex="-1"></a><span class="fu">summary</span>(model_taov)</span></code></pre></div>
<pre><code>##              Df    Sum Sq  Mean Sq F value   Pr(&gt;F)    
## species       2 145190219 72595110 758.358  &lt; 2e-16 ***
## sex           1  37090262 37090262 387.460  &lt; 2e-16 ***
## species:sex   2   1676557   838278   8.757 0.000197 ***
## Residuals   327  31302628    95727                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="regression-and-anova.html#cb184-1" tabindex="-1"></a><span class="co"># Make the APA-style table</span></span>
<span id="cb184-2"><a href="regression-and-anova.html#cb184-2" tabindex="-1"></a><span class="fu">apa.aov.table</span>(model_taov)</span></code></pre></div>
<pre><code>## 
## 
## ANOVA results using body_mass_g as the dependent variable
##  
## 
##      Predictor           SS  df           MS       F    p partial_eta2
##    (Intercept) 828480898.97   1 828480898.97 8654.65 .000             
##        species  60350016.02   2  30175008.01  315.22 .000          .66
##            sex  16613441.78   1  16613441.78  173.55 .000          .35
##  species x sex   1676556.74   2    838278.37    8.76 .000          .05
##          Error  31302628.28 327     95726.69                          
##  CI_90_partial_eta2
##                    
##          [.61, .69]
##          [.28, .41]
##          [.02, .09]
##                    
## 
## Note: Values in square brackets indicate the bounds of the 90% confidence interval for partial eta-squared</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="regression-and-anova.html#cb186-1" tabindex="-1"></a><span class="co"># Describe the result following the APA-style; but for reference ONLY!</span></span>
<span id="cb186-2"><a href="regression-and-anova.html#cb186-2" tabindex="-1"></a><span class="fu">report</span>(model_taov)</span></code></pre></div>
<pre><code>## The ANOVA (formula: body_mass_g ~ species * sex) suggests that:
## 
##   - The main effect of species is statistically significant and large (F(2, 327)
## = 758.36, p &lt; .001; Eta2 (partial) = 0.82, 95% CI [0.80, 1.00])
##   - The main effect of sex is statistically significant and large (F(1, 327) =
## 387.46, p &lt; .001; Eta2 (partial) = 0.54, 95% CI [0.49, 1.00])
##   - The interaction between species and sex is statistically significant and
## small (F(2, 327) = 8.76, p &lt; .001; Eta2 (partial) = 0.05, 95% CI [0.02, 1.00])
## 
## Effect sizes were labelled following Field&#39;s (2013) recommendations.</code></pre>
</div>
<div id="can-you-explain-to-me-how-those-results-have-been-obtained-1" class="section level3 hasAnchor" number="5.4.5">
<h3><span class="header-section-number">5.4.5</span> Can you explain to me how those results have been obtained?<a href="regression-and-anova.html#can-you-explain-to-me-how-those-results-have-been-obtained-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>I’ll leave this as food for thought for you!</li>
</ul>
</div>
<div id="how-can-we-interpret-the-results-1" class="section level3 hasAnchor" number="5.4.6">
<h3><span class="header-section-number">5.4.6</span> How can we interpret the results?<a href="regression-and-anova.html#how-can-we-interpret-the-results-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Let’s use an alpha level of 0.05 as the significance threshold. According to the results, the p-value for species is lower than the significance level, indicating that species has a significant effect on body mass. In other words, the group means for body mass differ significantly across the three species.</p></li>
<li><p>The p-value for sex is also below the alpha level of 0.05, suggesting that sex has a significant effect on body mass. In other words, there are differences in body mass between female and male penguins.</p></li>
<li><p>Lastly, the p-value for the interaction between species and sex (denoted as species:sex in the output) is below the significance threshold. This indicates a significant interaction between species and sex. That is, the effect of species on body mass is not consistent across the levels of sex, as observed in the plot above.</p></li>
</ul>
</div>
<div id="what-to-do-with-the-interaction-effect" class="section level3 hasAnchor" number="5.4.7">
<h3><span class="header-section-number">5.4.7</span> What to do with the interaction effect?<a href="regression-and-anova.html#what-to-do-with-the-interaction-effect" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>The interaction in the analysis suggests that it would be beneficial to examine the simple effects. The next step is to analyze the differences in body mass due to species within each level of sex.</p>
<ul>
<li><p>To do this, we will split the dataset and conduct a separate analysis for each level of sex.</p></li>
<li><p>Importantly, to do this, we use the mean-squared-within (i.e., <span class="math inline">\(\text{MS}_{\text{within}}\)</span>) from the full data to compute the F value, and then use the <code>pf</code> function to find the p-value.</p></li>
<li><p>To control the overall Type I error rate, we will use an alpha level of 0.025 for each test.</p></li>
</ul></li>
</ul>
<div id="what-are-you-talking-about-ihnwhi" class="section level4 hasAnchor" number="5.4.7.1">
<h4><span class="header-section-number">5.4.7.1</span> What are you talking about, Ihnwhi…?<a href="regression-and-anova.html#what-are-you-talking-about-ihnwhi" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="img/slide.png" /></p>
<ul>
<li>Let’s proceed with the analyses!</li>
</ul>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="regression-and-anova.html#cb188-1" tabindex="-1"></a><span class="co"># Split data</span></span>
<span id="cb188-2"><a href="regression-and-anova.html#cb188-2" tabindex="-1"></a><span class="do">## female</span></span>
<span id="cb188-3"><a href="regression-and-anova.html#cb188-3" tabindex="-1"></a>dat_f <span class="ot">&lt;-</span> <span class="fu">filter</span>(dat, sex <span class="sc">==</span> <span class="st">&quot;female&quot;</span>)</span>
<span id="cb188-4"><a href="regression-and-anova.html#cb188-4" tabindex="-1"></a>model_taov_f <span class="ot">&lt;-</span> <span class="fu">aov</span>(body_mass_g <span class="sc">~</span> species, <span class="at">data =</span> dat_f)</span>
<span id="cb188-5"><a href="regression-and-anova.html#cb188-5" tabindex="-1"></a><span class="fu">summary</span>(model_taov_f)</span></code></pre></div>
<pre><code>##              Df   Sum Sq  Mean Sq F value Pr(&gt;F)    
## species       2 60350016 30175008   393.2 &lt;2e-16 ***
## Residuals   162 12430757    76733                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="regression-and-anova.html#cb190-1" tabindex="-1"></a><span class="co"># MS_between from the subset of data</span></span>
<span id="cb190-2"><a href="regression-and-anova.html#cb190-2" tabindex="-1"></a>MS_b_f <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_taov_f)[[<span class="dv">1</span>]][<span class="dv">1</span>,<span class="dv">3</span>]</span>
<span id="cb190-3"><a href="regression-and-anova.html#cb190-3" tabindex="-1"></a></span>
<span id="cb190-4"><a href="regression-and-anova.html#cb190-4" tabindex="-1"></a><span class="co"># df_between frmo the subset of data</span></span>
<span id="cb190-5"><a href="regression-and-anova.html#cb190-5" tabindex="-1"></a>df_b_f <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_taov_f)[[<span class="dv">1</span>]][<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb190-6"><a href="regression-and-anova.html#cb190-6" tabindex="-1"></a></span>
<span id="cb190-7"><a href="regression-and-anova.html#cb190-7" tabindex="-1"></a><span class="co"># MS_within from the full data</span></span>
<span id="cb190-8"><a href="regression-and-anova.html#cb190-8" tabindex="-1"></a>MS_w <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_taov)[[<span class="dv">1</span>]][<span class="dv">4</span>,<span class="dv">3</span>]</span>
<span id="cb190-9"><a href="regression-and-anova.html#cb190-9" tabindex="-1"></a></span>
<span id="cb190-10"><a href="regression-and-anova.html#cb190-10" tabindex="-1"></a><span class="co"># df_within from the full data</span></span>
<span id="cb190-11"><a href="regression-and-anova.html#cb190-11" tabindex="-1"></a>df_w <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_taov)[[<span class="dv">1</span>]][<span class="dv">4</span>,<span class="dv">1</span>]</span>
<span id="cb190-12"><a href="regression-and-anova.html#cb190-12" tabindex="-1"></a></span>
<span id="cb190-13"><a href="regression-and-anova.html#cb190-13" tabindex="-1"></a><span class="co"># Calculate the F-value</span></span>
<span id="cb190-14"><a href="regression-and-anova.html#cb190-14" tabindex="-1"></a>F_f <span class="ot">&lt;-</span> MS_b_f<span class="sc">/</span>MS_w</span>
<span id="cb190-15"><a href="regression-and-anova.html#cb190-15" tabindex="-1"></a></span>
<span id="cb190-16"><a href="regression-and-anova.html#cb190-16" tabindex="-1"></a><span class="co"># Obtain the p-value</span></span>
<span id="cb190-17"><a href="regression-and-anova.html#cb190-17" tabindex="-1"></a>p_f <span class="ot">&lt;-</span> <span class="fu">pf</span>(F_f, <span class="at">df1 =</span> df_b_f, <span class="at">df2 =</span> df_w, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb190-18"><a href="regression-and-anova.html#cb190-18" tabindex="-1"></a></span>
<span id="cb190-19"><a href="regression-and-anova.html#cb190-19" tabindex="-1"></a><span class="co"># Make a statistical decision - Is p-value lower than the adjusted alpha?</span></span>
<span id="cb190-20"><a href="regression-and-anova.html#cb190-20" tabindex="-1"></a>p_f <span class="sc">&lt;</span> <span class="fl">0.025</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<ul>
<li><p>The results indicate that the p-value is lower than the adjusted alpha level of 0.025 based on Bonferroni’s correction. This suggests that there are significant mean differences across the three levels of species when the level of sex is female.</p></li>
<li><p>We do the same for the subset of the data where the level of sex is male.</p></li>
</ul>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="regression-and-anova.html#cb192-1" tabindex="-1"></a><span class="co"># Split data</span></span>
<span id="cb192-2"><a href="regression-and-anova.html#cb192-2" tabindex="-1"></a><span class="do">## male</span></span>
<span id="cb192-3"><a href="regression-and-anova.html#cb192-3" tabindex="-1"></a>dat_m <span class="ot">&lt;-</span> <span class="fu">filter</span>(dat, sex <span class="sc">==</span> <span class="st">&quot;male&quot;</span>)</span>
<span id="cb192-4"><a href="regression-and-anova.html#cb192-4" tabindex="-1"></a>model_taov_m <span class="ot">&lt;-</span> <span class="fu">aov</span>(body_mass_g <span class="sc">~</span> species, <span class="at">data =</span> dat_m)</span>
<span id="cb192-5"><a href="regression-and-anova.html#cb192-5" tabindex="-1"></a><span class="fu">summary</span>(model_taov_m)</span></code></pre></div>
<pre><code>##              Df   Sum Sq  Mean Sq F value Pr(&gt;F)    
## species       2 84728125 42364062   370.4 &lt;2e-16 ***
## Residuals   165 18871872   114375                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="regression-and-anova.html#cb194-1" tabindex="-1"></a><span class="co"># MS_between from the subset of data</span></span>
<span id="cb194-2"><a href="regression-and-anova.html#cb194-2" tabindex="-1"></a>MS_b_m <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_taov_m)[[<span class="dv">1</span>]][<span class="dv">1</span>,<span class="dv">3</span>]</span>
<span id="cb194-3"><a href="regression-and-anova.html#cb194-3" tabindex="-1"></a></span>
<span id="cb194-4"><a href="regression-and-anova.html#cb194-4" tabindex="-1"></a><span class="co"># df_between frmo the subset of data</span></span>
<span id="cb194-5"><a href="regression-and-anova.html#cb194-5" tabindex="-1"></a>df_b_m <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_taov_m)[[<span class="dv">1</span>]][<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb194-6"><a href="regression-and-anova.html#cb194-6" tabindex="-1"></a></span>
<span id="cb194-7"><a href="regression-and-anova.html#cb194-7" tabindex="-1"></a><span class="co"># MS_within from the full data</span></span>
<span id="cb194-8"><a href="regression-and-anova.html#cb194-8" tabindex="-1"></a>MS_w <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_taov)[[<span class="dv">1</span>]][<span class="dv">4</span>,<span class="dv">3</span>]</span>
<span id="cb194-9"><a href="regression-and-anova.html#cb194-9" tabindex="-1"></a></span>
<span id="cb194-10"><a href="regression-and-anova.html#cb194-10" tabindex="-1"></a><span class="co"># df_within from the full data</span></span>
<span id="cb194-11"><a href="regression-and-anova.html#cb194-11" tabindex="-1"></a>df_w <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_taov)[[<span class="dv">1</span>]][<span class="dv">4</span>,<span class="dv">1</span>]</span>
<span id="cb194-12"><a href="regression-and-anova.html#cb194-12" tabindex="-1"></a></span>
<span id="cb194-13"><a href="regression-and-anova.html#cb194-13" tabindex="-1"></a><span class="co"># Calculate the F-value</span></span>
<span id="cb194-14"><a href="regression-and-anova.html#cb194-14" tabindex="-1"></a>F_m <span class="ot">&lt;-</span> MS_b_m<span class="sc">/</span>MS_w</span>
<span id="cb194-15"><a href="regression-and-anova.html#cb194-15" tabindex="-1"></a></span>
<span id="cb194-16"><a href="regression-and-anova.html#cb194-16" tabindex="-1"></a><span class="co"># Obtain the p-value</span></span>
<span id="cb194-17"><a href="regression-and-anova.html#cb194-17" tabindex="-1"></a>p_m <span class="ot">&lt;-</span> <span class="fu">pf</span>(F_m, <span class="at">df1 =</span> df_b_m, <span class="at">df2 =</span> df_w, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb194-18"><a href="regression-and-anova.html#cb194-18" tabindex="-1"></a></span>
<span id="cb194-19"><a href="regression-and-anova.html#cb194-19" tabindex="-1"></a><span class="co"># Make a statistical decision - Is p-value lower than the adjusted alpha?</span></span>
<span id="cb194-20"><a href="regression-and-anova.html#cb194-20" tabindex="-1"></a>p_m <span class="sc">&lt;</span> <span class="fl">0.025</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<ul>
<li>Similarly, the p-value is lower than the adjusted alpha level of 0.025 based on Bonferroni’s correction. This indicates that there are significant mean differences across the three levels of species when the level of sex is male.</li>
</ul>
</div>
</div>
<div id="this-time-lets-use-pairwise-comparison-with-tukeys-hsd-to-elaborate-on-the-results-of-f." class="section level3 hasAnchor" number="5.4.8">
<h3><span class="header-section-number">5.4.8</span> This time, let’s use pairwise comparison with Tukey’s HSD to elaborate on the results of F.<a href="regression-and-anova.html#this-time-lets-use-pairwise-comparison-with-tukeys-hsd-to-elaborate-on-the-results-of-f." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>We will use the <code>lsmeans()</code> function to perform pairwise comparisons based on Tukey’s HSD.</li>
</ul>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="regression-and-anova.html#cb196-1" tabindex="-1"></a><span class="co"># Pairwise comparison</span></span>
<span id="cb196-2"><a href="regression-and-anova.html#cb196-2" tabindex="-1"></a><span class="fu">lsmeans</span>(model_taov, pairwise <span class="sc">~</span> species, <span class="at">by =</span> <span class="st">&quot;sex&quot;</span>, <span class="at">adjust =</span> <span class="st">&quot;tukey&quot;</span>)</span></code></pre></div>
<pre><code>## $lsmeans
## sex = female:
##  species   lsmean   SE  df lower.CL upper.CL
##  Adelie      3369 36.2 327     3298     3440
##  Chinstrap   3527 53.1 327     3423     3632
##  Gentoo      4680 40.6 327     4600     4760
## 
## sex = male:
##  species   lsmean   SE  df lower.CL upper.CL
##  Adelie      4043 36.2 327     3972     4115
##  Chinstrap   3939 53.1 327     3835     4043
##  Gentoo      5485 39.6 327     5407     5563
## 
## Confidence level used: 0.95 
## 
## $contrasts
## sex = female:
##  contrast           estimate   SE  df t.ratio p.value
##  Adelie - Chinstrap     -158 64.2 327  -2.465  0.0377
##  Adelie - Gentoo       -1311 54.4 327 -24.088  &lt;.0001
##  Chinstrap - Gentoo    -1153 66.8 327 -17.246  &lt;.0001
## 
## sex = male:
##  contrast           estimate   SE  df t.ratio p.value
##  Adelie - Chinstrap      105 64.2 327   1.627  0.2357
##  Adelie - Gentoo       -1441 53.7 327 -26.855  &lt;.0001
##  Chinstrap - Gentoo    -1546 66.2 327 -23.345  &lt;.0001
## 
## P value adjustment: tukey method for comparing a family of 3 estimates</code></pre>
<ul>
<li><p>Can you understand the results? Focus on the <code>$contrasts</code> section!</p></li>
<li><p>Can you expand on your results? Feel free to refer to the lecture slides for a template to guide your write-up.</p></li>
</ul>
</div>
</div>
<div id="regression-analysis" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Regression analysis<a href="regression-and-anova.html#regression-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p><strong>Purpose of Regression Analysis</strong>: Regression analysis is a statistical method used to examine the relationship between a dependent variable (outcome) and one or more independent variables (predictors). It helps quantify the strength and direction of these relationships.</p></li>
<li><p><strong>Key Objective</strong>: The primary goal is to model the relationship between variables, allowing researchers to explain variations in the dependent variable and make predictions about future or unobserved data points.</p></li>
<li><p><strong>Types of Regression</strong>: Regression analysis comes in various forms, such as simple regression (one predictor), multiple regression (multiple predictors), and specialized models (e.g., logistic regression for binary outcomes or polynomial regression for nonlinear relationships).</p></li>
<li><p><strong>Assumptions and Applications</strong>: Regression models rely on assumptions such as linearity, independence, homoscedasticity, and normality of residuals. It is widely applied in fields like psychology, economics, and engineering to analyze trends, test hypotheses, and predict outcomes. You will have a deeper understanding into the assumptions in PSY202B with Sarah!</p></li>
<li><p><strong>Tips When Programming</strong>: Be sure to differentiate what is regression on others!</p></li>
</ul>
<div id="simple-regression-analysis" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Simple regression analysis<a href="regression-and-anova.html#simple-regression-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>A simple regression model is used to describe the relationship between two variables: an independent variable (IV) and a dependent variable (DV).</p></li>
<li><p>The research question addressed by simple regression is whether the IV has an effect on the DV. If a significant effect is found, the model can be used to predict DV values for new IV values.</p></li>
<li><p>Assuming a linear relationship between the two variables, the mathematical expression for a simple regression model is <span class="math inline">\(y_i = b_0 + b_1x_i + \varepsilon_i\)</span>, where <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are the regression coefficients (intercept and slope, respectively), and <span class="math inline">\(\varepsilon_i\)</span> represents the error term.</p></li>
<li><p>The DV must be a continuous variable, while the IV can be either continuous or categorical.</p>
<ul>
<li>For example, one-way ANOVA is a special case of simple regression, where the IV is categorical.</li>
</ul></li>
</ul>
<div id="simple-regression-analysis-with-a-continuous-predictor" class="section level4 hasAnchor" number="5.5.1.1">
<h4><span class="header-section-number">5.5.1.1</span> Simple regression analysis with a continuous predictor<a href="regression-and-anova.html#simple-regression-analysis-with-a-continuous-predictor" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>Say our goal is to predict the ACT score using age through a simple regression analysis.</p></li>
<li><p>What would be the null hypothesis?</p></li>
</ul>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="regression-and-anova.html#cb198-1" tabindex="-1"></a><span class="co"># Use the sat-act data again</span></span>
<span id="cb198-2"><a href="regression-and-anova.html#cb198-2" tabindex="-1"></a>dat_satact <span class="ot">&lt;-</span> sat.act</span>
<span id="cb198-3"><a href="regression-and-anova.html#cb198-3" tabindex="-1"></a></span>
<span id="cb198-4"><a href="regression-and-anova.html#cb198-4" tabindex="-1"></a><span class="co"># Simple regression analysis, with a continuous predictor</span></span>
<span id="cb198-5"><a href="regression-and-anova.html#cb198-5" tabindex="-1"></a>model_reg_s_cont <span class="ot">&lt;-</span> <span class="fu">lm</span>(ACT <span class="sc">~</span> age, <span class="at">data =</span> dat_satact)</span>
<span id="cb198-6"><a href="regression-and-anova.html#cb198-6" tabindex="-1"></a><span class="fu">summary</span>(model_reg_s_cont)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ACT ~ age, data = dat_satact)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -25.3454  -3.1874   0.4301   3.6546   7.9915 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 27.11035    0.52148  51.988  &lt; 2e-16 ***
## age          0.05614    0.01910   2.939  0.00341 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.797 on 698 degrees of freedom
## Multiple R-squared:  0.01222,    Adjusted R-squared:  0.01081 
## F-statistic: 8.635 on 1 and 698 DF,  p-value: 0.003406</code></pre>
<ul>
<li>Can you understand the output and interpret the result?</li>
</ul>
</div>
<div id="simple-regression-analysis-with-a-categorical-predictor" class="section level4 hasAnchor" number="5.5.1.2">
<h4><span class="header-section-number">5.5.1.2</span> Simple regression analysis with a categorical predictor<a href="regression-and-anova.html#simple-regression-analysis-with-a-categorical-predictor" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>This time, say we would like to predict the ACT score using education through a simple regression analysis.</li>
</ul>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="regression-and-anova.html#cb200-1" tabindex="-1"></a><span class="co"># Simple regression analysis, with a continuous predictor</span></span>
<span id="cb200-2"><a href="regression-and-anova.html#cb200-2" tabindex="-1"></a>model_reg_s_cate <span class="ot">&lt;-</span> <span class="fu">lm</span>(ACT <span class="sc">~</span> <span class="fu">as.factor</span>(education), <span class="at">data =</span> dat_satact)</span>
<span id="cb200-3"><a href="regression-and-anova.html#cb200-3" tabindex="-1"></a><span class="fu">summary</span>(model_reg_s_cate)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ACT ~ as.factor(education), data = dat_satact)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -23.9773  -3.2945   0.5263   3.7055   9.0227 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)            27.4737     0.6319  43.480  &lt; 2e-16 ***
## as.factor(education)1   0.0152     0.9513   0.016  0.98725    
## as.factor(education)2  -0.4964     0.9573  -0.519  0.60425    
## as.factor(education)3   0.8209     0.6943   1.182  0.23748    
## as.factor(education)4   1.7872     0.7511   2.379  0.01761 *  
## as.factor(education)5   2.1292     0.7488   2.844  0.00459 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.771 on 694 degrees of freedom
## Multiple R-squared:  0.02887,    Adjusted R-squared:  0.02187 
## F-statistic: 4.126 on 5 and 694 DF,  p-value: 0.001063</code></pre>
<ul>
<li>Can you notice something from the above results compared to what we did as below?</li>
</ul>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="regression-and-anova.html#cb202-1" tabindex="-1"></a><span class="co"># Perform a one-way ANOVA</span></span>
<span id="cb202-2"><a href="regression-and-anova.html#cb202-2" tabindex="-1"></a>model_oaov <span class="ot">&lt;-</span> <span class="fu">aov</span>(ACT <span class="sc">~</span> education, <span class="at">data =</span> dat_satact)</span>
<span id="cb202-3"><a href="regression-and-anova.html#cb202-3" tabindex="-1"></a></span>
<span id="cb202-4"><a href="regression-and-anova.html#cb202-4" tabindex="-1"></a><span class="co"># Print the output</span></span>
<span id="cb202-5"><a href="regression-and-anova.html#cb202-5" tabindex="-1"></a><span class="fu">summary</span>(model_oaov)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## education     1    390   389.9   17.14 3.89e-05 ***
## Residuals   698  15874    22.7                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
</div>
<div id="multiple-regression-analysis" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Multiple regression analysis<a href="regression-and-anova.html#multiple-regression-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Multiple linear regression allows more than one IVs to predict the dependent variable (DV). To examine effects of multiple IVs on the DV, we can simply add IVs in the linear model, <span class="math inline">\(y_i = b_0 + b_1 x_{1i} + b_2 x_{2i} + \cdots + b_p x_{pi} + \varepsilon_i\)</span>.</li>
</ul>
<div id="multiple-regression-analysis-with-two-continuous-variables" class="section level4 hasAnchor" number="5.5.2.1">
<h4><span class="header-section-number">5.5.2.1</span> Multiple regression analysis with two continuous variables<a href="regression-and-anova.html#multiple-regression-analysis-with-two-continuous-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>Say our goal is to predict the body mass of penguins using flipper length and bill depth through a multiple regression analysis.</p></li>
<li><p>What would be the null hypothesis?</p></li>
</ul>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="regression-and-anova.html#cb204-1" tabindex="-1"></a><span class="co"># Load data again</span></span>
<span id="cb204-2"><a href="regression-and-anova.html#cb204-2" tabindex="-1"></a>dat_penguin <span class="ot">&lt;-</span> penguins</span>
<span id="cb204-3"><a href="regression-and-anova.html#cb204-3" tabindex="-1"></a></span>
<span id="cb204-4"><a href="regression-and-anova.html#cb204-4" tabindex="-1"></a><span class="co"># Multiple regression analysis</span></span>
<span id="cb204-5"><a href="regression-and-anova.html#cb204-5" tabindex="-1"></a>model_reg_m_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass_g <span class="sc">~</span> flipper_length_mm <span class="sc">+</span> bill_depth_mm, <span class="at">data =</span> dat_penguin)</span>
<span id="cb204-6"><a href="regression-and-anova.html#cb204-6" tabindex="-1"></a><span class="fu">summary</span>(model_reg_m_1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = body_mass_g ~ flipper_length_mm + bill_depth_mm, 
##     data = dat_penguin)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1029.78  -271.45   -23.58   245.15  1275.97 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       -6541.907    540.751 -12.098   &lt;2e-16 ***
## flipper_length_mm    51.541      1.865  27.635   &lt;2e-16 ***
## bill_depth_mm        22.634     13.280   1.704   0.0892 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 393.2 on 339 degrees of freedom
##   (2 observations deleted due to missingness)
## Multiple R-squared:  0.761,  Adjusted R-squared:  0.7596 
## F-statistic: 539.8 on 2 and 339 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li>Can you understand the output and interpret the result?</li>
</ul>
</div>
<div id="model-diagnostics-for-multiple-regression-analysis" class="section level4 hasAnchor" number="5.5.2.2">
<h4><span class="header-section-number">5.5.2.2</span> Model diagnostics for multiple regression analysis<a href="regression-and-anova.html#model-diagnostics-for-multiple-regression-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Trailer: Again, much more in Sarah’s PSY202B!</p>
</blockquote>
<ul>
<li>For the purpose of diagnosing model assumptions, we can check four diagnostic plots: (1) residuals vs. fitted, (2) normal Q-Q, (3) scale-loation, (4) Cook’s distance, and (5) residuals vs. leverage.</li>
</ul>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="regression-and-anova.html#cb206-1" tabindex="-1"></a><span class="co"># Model diagnostics using visual tools</span></span>
<span id="cb206-2"><a href="regression-and-anova.html#cb206-2" tabindex="-1"></a><span class="fu">plot</span>(model_reg_m_1, <span class="at">which =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="PSY202A-Modeling-I.Heo_files/figure-html/unnamed-chunk-118-1.png" width="672" /></p>
<ul>
<li>A visual examination of the residuals vs. fitted plot indicates that there is equal variance along the line of best fit (i.e., regression line). Therefore, the assumption of homoscedasticity is met. In addition, the points are randomly scattered across the place, and there are no discernible nonlinear trends. This means that the assumption of linearity is also met.</li>
</ul>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="regression-and-anova.html#cb207-1" tabindex="-1"></a><span class="co"># Model diagnostics using visual tools</span></span>
<span id="cb207-2"><a href="regression-and-anova.html#cb207-2" tabindex="-1"></a><span class="fu">plot</span>(model_reg_m_1, <span class="at">which =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="PSY202A-Modeling-I.Heo_files/figure-html/unnamed-chunk-119-1.png" width="672" /></p>
<ul>
<li>The Q-Q plot shows that there is a slight deviation in the lower-left corner, but this is not severe and looks okay. Also, most of the data points hover around the normal line. Thus, the normality assumption is met.</li>
</ul>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="regression-and-anova.html#cb208-1" tabindex="-1"></a><span class="co"># Model diagnostics using visual tools</span></span>
<span id="cb208-2"><a href="regression-and-anova.html#cb208-2" tabindex="-1"></a><span class="fu">plot</span>(model_reg_m_1, <span class="at">which =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="PSY202A-Modeling-I.Heo_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
<ul>
<li>The scale-location plot tells us whether the assumption of homoscedasticity is satisfied or violated. If a model satisfies this assumption, the points should ideally be equally spread around the red horizontal line. According to the plot, the red horizontal line is fairly flat, which suggests that the assumption of homoscedasticity is met. While observations such as 40, 166, and 170 deviate slightly more, I do not believe this indicates a severe violation of the homoscedasticity assumption.</li>
</ul>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="regression-and-anova.html#cb209-1" tabindex="-1"></a><span class="co"># Model diagnostics using visual tools</span></span>
<span id="cb209-2"><a href="regression-and-anova.html#cb209-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb209-3"><a href="regression-and-anova.html#cb209-3" tabindex="-1"></a><span class="fu">plot</span>(model_reg_m_1, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb209-4"><a href="regression-and-anova.html#cb209-4" tabindex="-1"></a><span class="fu">plot</span>(model_reg_m_1, <span class="at">which =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="PSY202A-Modeling-I.Heo_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="regression-and-anova.html#cb210-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<ul>
<li><p>To diagnose the existence of influential points that can alter the results of the regression analysis upon the inclusion or exclusion of a value, I checked the Cook’s distance plot and the residuals vs. leverage plot. Cook’s distance measures the influence of each data point on the fitted model. Larger values of Cook’s distance, such as those greater than 0.5, indicate more influential points. According to the Cook’s distance plot, values from observations 40, 170, 166 could be influential, so those values are worthy of closer scrutiny.</p></li>
<li><p>I checked the residuals vs. leverage plot. According to this plot, observations with standardized residuals greater than 3 in absolute value are possible outliers. Indeed, there were three values whose absolute standardized residuals exceeded 3 (values from observations 40, 166, and 170), indicating the potential presence of outliers.</p></li>
<li><p>In sum, the assumption of no influential points is likely violated, at least for three specific observations. These values should be closely examined in the substantive research context.</p></li>
</ul>
</div>
<div id="multiple-regression-analysis-with-one-continuous-variable-and-one-categorical-variable" class="section level4 hasAnchor" number="5.5.2.3">
<h4><span class="header-section-number">5.5.2.3</span> Multiple regression analysis with one continuous variable and one categorical variable<a href="regression-and-anova.html#multiple-regression-analysis-with-one-continuous-variable-and-one-categorical-variable" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>Say our goal is to predict the body mass of penguins using flipper length and sex through a multiple regression analysis.</p></li>
<li><p>We use female as a reference category (i.e., coded as 0), where male is coded as 1.</p></li>
<li><p>What would be the null hypothesis?</p></li>
</ul>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="regression-and-anova.html#cb211-1" tabindex="-1"></a><span class="co"># Quick data engineering</span></span>
<span id="cb211-2"><a href="regression-and-anova.html#cb211-2" tabindex="-1"></a>dat_penguin <span class="ot">&lt;-</span> dat_penguin <span class="sc">%&gt;%</span></span>
<span id="cb211-3"><a href="regression-and-anova.html#cb211-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_dummy =</span> <span class="fu">if_else</span>(sex <span class="sc">==</span> <span class="st">&quot;male&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb211-4"><a href="regression-and-anova.html#cb211-4" tabindex="-1"></a></span>
<span id="cb211-5"><a href="regression-and-anova.html#cb211-5" tabindex="-1"></a><span class="co"># Multiple regression analysis</span></span>
<span id="cb211-6"><a href="regression-and-anova.html#cb211-6" tabindex="-1"></a>model_reg_m_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass_g <span class="sc">~</span> flipper_length_mm <span class="sc">+</span> sex_dummy, <span class="at">data =</span> dat_penguin)</span>
<span id="cb211-7"><a href="regression-and-anova.html#cb211-7" tabindex="-1"></a><span class="fu">summary</span>(model_reg_m_2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = body_mass_g ~ flipper_length_mm + sex_dummy, data = dat_penguin)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -910.28 -243.89   -2.94  238.85 1067.73 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       -5410.300    285.798 -18.931  &lt; 2e-16 ***
## flipper_length_mm    46.982      1.441  32.598  &lt; 2e-16 ***
## sex_dummy           347.850     40.342   8.623 2.78e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 355.9 on 330 degrees of freedom
##   (11 observations deleted due to missingness)
## Multiple R-squared:  0.8058, Adjusted R-squared:  0.8047 
## F-statistic: 684.8 on 2 and 330 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li>Can you understand the output and interpret the result?</li>
</ul>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="summarizing-data.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["PSY202A-Modeling-I.Heo.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
